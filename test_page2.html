<!DOCTYPE html>
<html>

<head>
	<meta charset='utf-8' />
	<title>map deux</title>
	<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
	<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.js'></script>
	<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.css' rel='stylesheet' />
	<style>
		body { margin:0px; padding:0px; }
		#map { position:absolute; top:0; bottom:0; width:100%; }
	</style>
</head>

<body>

<style>

.legend {
	background-color: #fff;
	border-radius: 3px;
	bottom: 30px;
	box-shadow: 0 1px 2px rgba(0,0,0,0.10);
	font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
	padding: 10px;
	position: absolute;
	right: 10px;
	z-index: 1;
}

.legend h4 {
	margin: 0 0 10px;
}

.legend div span {
	border-radius: 50%;
	display: inline-block;
	height: 10px;
	margin-right: 5px;
	width: 10px;
}

.mapboxgl-popup {
	max-width: 400px;
	font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
}

</style>

<div id='map'></div>

<div id='grid-legend' class='legend' style='display: block;'>
    <h4>Values</h4>
    <div><span style='background-color: #BF004B'></span>1.0</div>
    <div><span style='background-color: #AB1651'></span>0.9</div>
    <div><span style='background-color: #982D57'></span>0.8</div>
    <div><span style='background-color: #85445E'></span>0.7</div>
    <div><span style='background-color: #725B64'></span>0.6</div>
    <div><span style='background-color: #5F726B'></span>0.5</div>
    <div><span style='background-color: #4C8971'></span>0.4</div>
    <div><span style='background-color: #39A077'></span>0.3</div>
    <div><span style='background-color: #26B77E'></span>0.2</div>
    <div><span style='background-color: #13CE84'></span>0.1</div>
    <div><span style='background-color: #00E58B'></span>0.0</div>
</div>

<script>

mapboxgl.accessToken = 'pk.eyJ1IjoicGJlbGFub3YiLCJhIjoiY2o0ZmExOWU1MGQ1ODJ4cnY1NzNmNTFydyJ9.d1FatRMukTPDwhIqBhEJGQ';
var map = new mapboxgl.Map({
	container: 'map', // container id
	style: 'mapbox://styles/mapbox/basic-v9', //stylesheet location
	center: [8.231496, 46.788494], // starting position
	zoom: 7 // starting zoom
});

map.on('load', function () {

	var url = 'https://raw.githubusercontent.com/pbelanov/try_mapbox/master/grid.json';
	map.addSource('grid', { type: 'geojson', data: url });

	map.addLayer({
		'id': 'grid',
		'type': 'fill',
		'source': 'grid',
		'layout': {},
		'paint': {
			'fill-color': {
				property: 'random-value',
				stops: [
					[0.0, '#00E58B'],
					[0.1, '#13CE84'],
					[0.2, '#26B77E'],
					[0.3, '#39A077'],
					[0.4, '#4C8971'],
					[0.5, '#5F726B'],
					[0.6, '#725B64'],
					[0.7, '#85445E'],
					[0.8, '#982D57'],
					[0.9, '#AB1651'],
					[1.0, '#BF004B']
				]
			},
			'fill-opacity': 0.4
		}
	}, 'water');

  map.on('click', 'grid', function (e) {
		new mapboxgl.Popup()
			.setLngLat(e.lngLat)
			.setHTML(e.features[0].properties.description)
			.addTo(map);
  });

  map.on('mouseenter', 'grid', function () {
		map.getCanvas().style.cursor = 'pointer';
  });

  map.on('mouseleave', 'grid', function () {
		map.getCanvas().style.cursor = '';
  });

});

</script>

</body>

</html>